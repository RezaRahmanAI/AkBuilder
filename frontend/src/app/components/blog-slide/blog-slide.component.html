<div>
  @let isLoading = isLoading$ | async;
  @let loadError = loadError$ | async;
  @let blogs = blogs$ | async;

  @if (loadError) {
    <div class="mx-auto max-w-xl rounded-3xl border border-dashed border-accent/40 bg-pure/90 p-6 text-center text-steel">
      <h3 class="text-lg font-semibold text-carbon">Fresh stories are on pause.</h3>
      <p class="mt-2 text-sm">Please refresh to try again—the latest updates will return shortly.</p>
      <button
        type="button"
        (click)="loadBlogs()"
        class="mt-4 inline-flex items-center gap-2 rounded-full bg-brand px-5 py-2.5 text-sm font-semibold text-carbon shadow-sm transition hover:-translate-y-0.5 hover:bg-accent"
      >
        <i class="ri-refresh-line" aria-hidden="true"></i>
        Retry
      </button>
    </div>
  } @else {
    <div class="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3" role="list" aria-live="polite">
      @if (isLoading) {
        <div class="h-80 animate-pulse rounded-2xl bg-steel/15" *ngFor="let _ of [1,2,3]"></div>
      } @else if (blogs?.length) {
        <article
          *ngFor="let blog of (blogs | slice: 0 : 3); trackBy: trackById"
          role="listitem"
          class="group flex flex-col gap-4"
        >
          <a [routerLink]="['/blogs', blog.id]" class="flex h-full flex-col gap-4">
            <div class="h-52 w-full overflow-hidden rounded-2xl bg-steel/10">
              <img
                [src]="imageUrl(blog.image)"
                [alt]="blog.title || 'Blog card'"
                loading="lazy"
                class="h-full w-full object-cover transition duration-700 group-hover:scale-105"
              />
            </div>
            <div class="flex flex-1 flex-col gap-2">
              <div class="flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.2em] text-steel">
                <span>{{ blog.name || 'Updates' }}</span>
                <span class="h-1 w-1 rounded-full bg-steel/60"></span>
                <span>{{ blog.postedDate | date: 'MMM d, y' }}</span>
              </div>
              <h3 class="text-xl font-semibold leading-tight text-carbon transition-colors group-hover:text-accent line-clamp-2">
                {{ blog.title }}
              </h3>
              <p class="text-sm leading-relaxed text-steel line-clamp-3">
                {{ blog.description }}
              </p>
              <span class="mt-1 inline-flex items-center gap-1 text-sm font-semibold text-accent transition-all group-hover:gap-2">
                Read article
                <i class="ri-arrow-right-line" aria-hidden="true"></i>
              </span>
            </div>
          </a>
        </article>
      } @else {
        <div class="w-full rounded-3xl border border-dashed border-steel/30 bg-pure/90 p-8 text-center text-steel md:col-span-2 lg:col-span-3">
          <span class="text-xs font-semibold uppercase tracking-[0.32em] text-accent/70">Journal in progress</span>
          <p class="mt-3 text-sm">We're curating the first stories—check back soon.</p>
        </div>
      }
    </div>
  }
</div>
