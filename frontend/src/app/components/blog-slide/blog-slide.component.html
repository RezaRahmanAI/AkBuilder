<div>
  @let isLoading = isLoading$ | async;
  @let loadError = loadError$ | async;
  @let blogs = blogs$ | async;

  @if (loadError) {
    <div class="mx-auto max-w-xl rounded-3xl border border-dashed border-background-dark/10 dark:border-gray-700 bg-white/90 dark:bg-[#1a2632]/80 p-6 text-center text-background-dark/60 dark:text-gray-400">
      <h3 class="text-lg font-semibold text-background-dark dark:text-white">Fresh stories are on pause.</h3>
      <p class="mt-2 text-sm">Please refresh to try again—the latest updates will return shortly.</p>
      <button
        type="button"
        (click)="loadBlogs()"
        class="mt-4 inline-flex items-center gap-2 rounded-full bg-primary px-5 py-2.5 text-sm font-semibold text-background-dark shadow-sm transition hover:-translate-y-0.5 hover:bg-primary/90"
      >
        <i class="ri-refresh-line" aria-hidden="true"></i>
        Retry
      </button>
    </div>
  } @else {
    <div class="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3" role="list" aria-live="polite">
      @if (isLoading) {
        <div class="h-80 animate-pulse rounded-xl bg-gray-200/70 dark:bg-gray-700/40" *ngFor="let _ of [1,2,3]"></div>
      } @else if (blogs?.length) {
        <article
          *ngFor="let blog of (blogs | slice: 0 : 3); trackBy: trackById"
          role="listitem"
          class="flex flex-col gap-4 group cursor-pointer"
        >
          <a [routerLink]="['/blogs', blog.id]" class="flex h-full flex-col gap-4">
            <div class="w-full h-52 rounded-xl bg-cover bg-center overflow-hidden relative">
              <img
                [src]="imageUrl(blog.image)"
                [alt]="blog.title || 'Blog card'"
                loading="lazy"
                class="h-full w-full object-cover transition duration-700 group-hover:scale-105"
              />
            </div>
            <div class="flex flex-1 flex-col gap-2">
              <div class="flex items-center gap-2 text-xs font-bold text-background-dark/60 dark:text-gray-400 uppercase tracking-wider">
                <span>{{ blog.name || 'Updates' }}</span>
                <span class="w-1 h-1 rounded-full bg-gray-400"></span>
                <span>{{ blog.postedDate | date: 'MMM d, y' }}</span>
              </div>
              <h3 class="text-background-dark dark:text-white text-xl font-bold leading-tight group-hover:text-primary transition-colors line-clamp-2">
                {{ blog.title }}
              </h3>
              <p class="text-background-dark/60 dark:text-gray-400 text-sm leading-relaxed line-clamp-3">
                {{ blog.description }}
              </p>
              <span class="text-primary font-bold text-sm mt-1 flex items-center gap-1 group-hover:gap-2 transition-all">
                Read article <span class="material-symbols-outlined text-base">arrow_forward</span>
              </span>
            </div>
          </a>
        </article>
      } @else {
        <div class="w-full rounded-3xl border border-dashed border-background-dark/10 dark:border-gray-700 bg-white/90 dark:bg-[#1a2632]/80 p-8 text-center text-background-dark/60 dark:text-gray-400 md:col-span-2 lg:col-span-3">
          <span class="text-xs font-bold uppercase tracking-[0.32em] text-primary/80">Journal in progress</span>
          <p class="mt-3 text-sm">We're curating the first stories—check back soon.</p>
        </div>
      }
    </div>
  }
</div>
