<section class="grid gap-6 md:gap-8">
  <header
    class="flex flex-wrap items-center justify-between gap-6 md:gap-10 rounded-2xl border border-steel/20 bg-pure p-6 md:p-8 shadow-industrial-soft"
  >
    <div class="max-w-2xl">
      <span class="uppercase tracking-wider text-xs text-steel"
        >Portfolio overview</span
      >
      <h1
        class="font-serif text-[1.9rem] leading-tight text-charcoal md:text-4xl mt-2 mb-2"
      >
        Curate every project with a polished, modern view
      </h1>
      <p class="text-steel text-sm md:text-base">
        Monitor inventory, highlights, and customer interest without leaving the dashboard.
      </p>
    </div>
  </header>

  <div class="grid gap-6 md:grid-cols-2 xl:grid-cols-3">
    <section
      class="grid gap-5 rounded-2xl border border-steel/20 bg-pure p-6 md:col-span-2 md:p-8 shadow-industrial-soft"
    >
      <header class="flex flex-wrap items-center justify-between gap-4">
        <div>
          <h2 class="font-serif text-xl text-charcoal">Latest projects</h2>
          <p class="text-sm text-steel">
            Quick access to the newest listings and their status.
          </p>
        </div>
        <a
          routerLink="/dashboard/projects"
          class="text-brand underline underline-offset-4 transition hover:text-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40 focus-visible:ring-offset-2 focus-visible:ring-offset-pure"
        >
          View all listings
        </a>
      </header>

      <div class="grid gap-4 sm:grid-cols-2">
        <a
          *ngFor="let project of projects"
          class="group flex flex-col overflow-hidden rounded-xl border border-steel/15 bg-pure shadow-industrial-soft transition-all hover:-translate-y-0.5 hover:border-brand/30 hover:shadow-industrial-strong focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40 focus-visible:ring-offset-2 focus-visible:ring-offset-pure"
          [routerLink]="['/dashboard/projects', project.id, 'edit']"
        >
          <div class="relative aspect-[4/3] bg-steel/10 overflow-hidden">
            <img
              class="h-full w-full object-cover group-hover:scale-105 transition-transform duration-500"
              [src]="baseUrl + '/api/attachment/get/' + project.thumbnail"
              [alt]="project.name"
              (error)="onImageError($event)"
            />
            <span
              class="absolute left-3 top-3 inline-flex items-center gap-1 rounded-full border px-2.5 py-1 text-xs font-semibold"
              [ngClass]="statusBadgeClass(project.category)"
            >
              <span class="h-2 w-2 rounded-full" [ngClass]="statusDotClass(project.category)"></span>
              {{ project.category || 'Status' }}
            </span>
          </div>
          <div class="flex flex-col gap-2 p-4">
            <div class="flex items-start justify-between gap-2">
              <h3 class="text-lg font-semibold text-charcoal">{{ project.name }}</h3>
              <span class="text-xs font-medium text-steel">{{
                project.type || 'Mixed use'
              }}</span>
            </div>
            <p class="text-sm text-steel truncate">
              {{ project.address || 'Address forthcoming' }}
            </p>
            <div class="flex items-center gap-3 text-xs text-steel/70">
              <span>{{ project.landArea || 'N/A' }} land</span>
              <span class="h-3 w-px bg-steel/30"></span>
              <span>{{ project.numberOfApartments || 0 }} apartments</span>
            </div>
          </div>
        </a>

        <div
          *ngIf="projects.length === 0 && !projectsError"
          class="rounded-xl border border-dashed border-steel/30 bg-steel/10 p-6 text-center text-steel"
        >
          No listings available yet. Add your first residence.
        </div>
      </div>
      <p *ngIf="projectsError" class="text-sm text-power">{{ projectsError }}</p>
    </section>

    <div class="grid gap-6 md:grid-cols-2 xl:grid-cols-1">
      <article
        class="grid gap-4 rounded-2xl border border-steel/20 bg-pure p-6 shadow-industrial-soft"
      >
        <div class="flex items-center justify-between">
          <div>
            <span class="uppercase tracking-[0.2em] text-[0.7rem] text-steel"
              >Project insights</span
            >
            <p class="text-sm text-steel mt-1">
              Active inventory split by category.
            </p>
          </div>
          <strong class="text-3xl font-serif text-charcoal">
            {{ projectSummary?.active || 0 }}
          </strong>
        </div>

        <div class="grid gap-3 text-sm text-steel">
          <div
            class="flex items-center justify-between rounded-lg border border-steel/10 bg-steel/10 px-3 py-2"
          >
            <span class="inline-flex items-center gap-2">
              <span class="h-2 w-2 rounded-full bg-brand"></span>
              Ongoing
            </span>
            <span class="font-semibold text-charcoal">{{
              projectSummary?.ongoing || 0
            }}</span>
          </div>
          <div
            class="flex items-center justify-between rounded-lg border border-steel/10 bg-steel/10 px-3 py-2"
          >
            <span class="inline-flex items-center gap-2">
              <span class="h-2 w-2 rounded-full bg-accent"></span>
              Upcoming
            </span>
            <span class="font-semibold text-charcoal">{{
              projectSummary?.upcoming || 0
            }}</span>
          </div>
          <div
            class="flex items-center justify-between rounded-lg border border-steel/10 bg-steel/10 px-3 py-2"
          >
            <span class="inline-flex items-center gap-2">
              <span class="h-2 w-2 rounded-full bg-power"></span>
              Completed
            </span>
            <span class="font-semibold text-charcoal">{{
              projectSummary?.completed || 0
            }}</span>
          </div>
          <div
            class="flex items-center justify-between rounded-lg border border-steel/10 bg-steel/10 px-3 py-2"
          >
            <span class="inline-flex items-center gap-2">
              <span class="h-2 w-2 rounded-full bg-steel"></span>
              Total projects
            </span>
            <span class="font-semibold text-charcoal">{{
              projectSummary?.total || 0
            }}</span>
          </div>
        </div>
      </article>

      <article
        class="grid gap-2 rounded-2xl border border-steel/20 bg-pure p-6 shadow-industrial-soft"
      >
        <span class="uppercase tracking-[0.2em] text-[0.7rem] text-steel"
          >Client inquiries</span
        >
        <strong class="font-serif text-4xl text-charcoal">{{ totalInquiries }}</strong>
        <small *ngIf="inquiriesError" class="text-power">{{ inquiriesError }}</small>

        <div class="grid gap-2 text-steel text-sm">
          <span
            class="relative block h-2.5 rounded-full overflow-hidden bg-steel/15"
          >
            <span
              class="absolute inset-y-0 left-0 rounded-full bg-gradient-to-r from-brand to-accent"
              [style.width.%]="Math.min(totalInquiries, 100)"
            ></span>
          </span>
          <span>{{ totalInquiries | number }} touch points this quarter</span>
        </div>
      </article>
    </div>
  </div>
</section>
