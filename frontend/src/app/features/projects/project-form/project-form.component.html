<div class="rounded-3xl border border-slate-200 bg-white p-5 shadow-xl sm:p-8">
  <form (ngSubmit)="saveProject()" enctype="multipart/form-data" class="space-y-6">
    <div class="grid gap-4 sm:gap-6 sm:grid-cols-2">
      <!-- Name -->
      <div class="sm:col-span-2">
        <label for="name" class="mb-2 block text-sm font-medium text-slate-600">Name</label>
        <input id="name" [(ngModel)]="_project.name" name="name" type="text"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700 bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter Name" required />
        <input *ngIf="mode === 'edit'" id="id" [(ngModel)]="_project.id" name="id" type="text" class="hidden" />
      </div>

      <!-- Category -->
      <div>
        <label for="category" class="mb-2 block text-sm font-medium text-slate-600">Category</label>
        <select id="category" [(ngModel)]="_project.category" name="category"
                class="block w-full p-2 sm:p-3 text-sm text-slate-700 bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200">
          <option value="">Select category</option>
          <option value="Ongoing">Ongoing</option>
          <option value="Upcoming">Upcoming</option>
          <option value="Completed">Completed</option>
          <option value="Handover">Handover</option>
        </select>
      </div>

      <!-- Type -->
      <div>
        <label for="type" class="mb-2 block text-sm font-medium text-slate-600">Type</label>
        <select id="type" [(ngModel)]="_project.type" name="type"
                class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200">
          <option value="">Select type</option>
          <option value="Residential">Residential</option>
          <option value="Commercial">Commercial</option>
          <option value="Land">Land</option>
        </select>
      </div>

      <!-- Description -->
      <div class="sm:col-span-2">
        <label for="description" class="mb-2 block text-sm font-medium text-slate-600">Description</label>
        <textarea id="description" [(ngModel)]="_project.description" name="description" rows="3"
                  class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
                  placeholder="Write description here"></textarea>
      </div>

      <!-- Address -->
      <div class="sm:col-span-2">
        <label for="address" class="mb-2 block text-sm font-medium text-slate-600">Address</label>
        <textarea id="address" [(ngModel)]="_project.address" name="address" rows="3"
                  class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
                  placeholder="Write address here"></textarea>
      </div>

      <!-- Land Area -->
      <div>
        <label for="landArea" class="mb-2 block text-sm font-medium text-slate-600">Land Area</label>
        <input id="landArea" [(ngModel)]="_project.landArea" name="landArea" type="text"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter land area" />
      </div>

      <!-- Built Up Area -->
      <div>
        <label for="builtUpArea" class="mb-2 block text-sm font-medium text-slate-600">Built Up Area</label>
        <input id="builtUpArea" [(ngModel)]="_project.builtUpArea" name="builtUpArea" type="text"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter built up area" />
      </div>

      <!-- Height -->
      <div>
        <label for="height" class="mb-2 block text-sm font-medium text-slate-600">Height</label>
        <input id="height" [(ngModel)]="_project.height" name="height" type="text"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter height" />
      </div>

      <!-- Number of Apartments -->
      <div>
        <label for="numberOfApartments" class="mb-2 block text-sm font-medium text-slate-600">Number of Apartments</label>
        <input id="numberOfApartments" [(ngModel)]="_project.numberOfApartments" name="numberOfApartments" type="number"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter number of apartments" />
      </div>

      <!-- Number of Parking -->
      <div>
        <label for="numberOfParking" class="mb-2 block text-sm font-medium text-slate-600">Number of Parkings</label>
        <input id="numberOfParking" [(ngModel)]="_project.numberOfParking" name="numberOfParking" type="number"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter number of parking" />
      </div>

      <!-- Number of Motor Parking -->
      <div>
        <label for="noOfMotorParking" class="mb-2 block text-sm font-medium text-slate-600">Number of Motor Parkings</label>
        <input id="noOfMotorParking" [(ngModel)]="_project.noOfMotorParking" name="noOfMotorParking" type="number"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter number of parking" />
      </div>

      <!-- Unit Per Floors -->
      <div>
        <label for="unitPerFloors" class="mb-2 block text-sm font-medium text-slate-600">Unit Per Floors</label>
        <input id="unitPerFloors" [(ngModel)]="_project.unitPerFloors" name="unitPerFloors" type="text"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter unit per floors" />
      </div>

      <!-- Size of Each Apartment -->
      <div>
        <label for="sizeOfEachApartment" class="mb-2 block text-sm font-medium text-slate-600">Size of Each Apartment</label>
        <input id="sizeOfEachApartment" [(ngModel)]="_project.sizeOfEachApartment" name="sizeOfEachApartment" type="text"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter size of each apartment" />
      </div>

      <!-- Map Link -->
      <div>
        <label for="mapLink" class="mb-2 block text-sm font-medium text-slate-600">Map Link</label>
        <input id="mapLink" [(ngModel)]="_project.mapLink" name="mapLink" type="text"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter map link" />
      </div>

      <!-- Video Link -->
      <div>
        <label for="videoLink" class="mb-2 block text-sm font-medium text-slate-600">Video Link</label>
        <input id="videoLink" [(ngModel)]="_project.videoLink" name="videoLink" type="text"
               class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
               placeholder="Enter video link" />
      </div>

      <!-- PDF -->
      <div>
        <label for="pdfUpload" class="mb-2 block text-sm font-medium text-slate-600">Upload brochure PDF</label>
        <input
          id="pdfUpload"
          type="file"
          accept="application/pdf"
          (change)="onPdfChange($event)"
          class="block w-full rounded-xl border border-slate-200 bg-slate-50 p-2 text-sm text-slate-700 transition focus:border-brand focus:bg-white focus:outline-none focus:ring-2 focus:ring-brand"
        />

        <!-- Error message -->
        <p *ngIf="pdfError" class="mt-1 text-sm text-rose-500">
          {{ pdfError }}
        </p>
      </div>


      <!-- Thumbnail -->
      <div>
        <label for="thumbnail" class="mb-2 block text-sm font-medium text-slate-600">Thumbnail</label>
        <input
          class="block w-full cursor-pointer rounded-xl border border-slate-200 bg-slate-50 p-2 text-sm text-slate-700 transition file:mr-3 file:rounded-lg file:border-0 file:bg-brand/10 file:px-3 file:py-1.5 file:text-brand hover:file:bg-brand/20 focus:border-brand focus:bg-white focus:outline-none focus:ring-2 focus:ring-brand"
          id="thumbnail"
          name="thumbnail"
          type="file"
          accept="image/*"
          (change)="onThumbnailChange($event)"
        />
        <p class="mt-1 text-xs sm:text-sm text-gray-500">SVG, PNG, JPG or GIF (MAX. 800x400px).</p>
        <div *ngIf="thumbnailPreview" class="mt-2">
          <img [src]="thumbnailPreview" alt="Thumbnail Preview" class="max-w-full h-auto rounded-lg" style="max-height: 200px;" />
          <button
            *ngIf="mode === 'edit' && _project.thumbnail && !selectedThumbnail"
            type="button"
            (click)="startCropping(_project.thumbnail, 'thumbnail')"
            class="mt-2 inline-flex items-center gap-2 rounded-full bg-brand px-4 py-1 text-sm font-medium text-white transition hover:bg-brand/90"
          >
            Edit existing image
          </button>
          <button
            *ngIf="selectedThumbnail"
            type="button"
            (click)="startCropping(selectedThumbnail, 'thumbnail')"
            class="mt-2 inline-flex items-center gap-2 rounded-full bg-brand px-4 py-1 text-sm font-medium text-white transition hover:bg-brand/90"
          >
            Edit image
          </button>
        </div>
      </div>

      <!-- Content Type -->
      <!-- <div>
        <label for="contentType" class="mb-2 block text-sm font-medium text-slate-600">Content Type</label>
        <select id="contentType" [(ngModel)]="contentType" name="contentType"
                class="block w-full p-2 sm:p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200">
          <option value="">Select content type</option>
          <option value="Image">Image</option>
          <option value="Video">Video</option>
        </select>
      </div> -->

      <!-- Content -->
      <!-- <div>
        <label for="content" class="mb-2 block text-sm font-medium text-slate-600">{{ contentType === 'Video' ? 'Content (Video max 15MB)' : 'Content' }}</label>
        <input class="block w-full text-sm text-slate-700 border border-slate-200 rounded-lg cursor-pointer  bg-slate-50 focus:outline-none transition-all duration-200"
               id="content" name="content" type="file" [accept]="contentType === 'Video' ? 'video/*' : 'image/*'" (change)="onContentChange($event)" />
        <div *ngIf="contentPreview" class="mt-2">
          <img *ngIf="contentType === 'Image'" [src]="contentPreview" alt="Content Preview" class="max-w-full h-auto rounded-lg" style="max-height: 200px;" />
          <button *ngIf="contentType === 'Image' && mode === 'edit' && _project.content && !selectedContent" type="button" (click)="startCropping(_project.content, 'content')"
                  class="mt-2 px-4 py-1 text-white bg-accent rounded-lg">Edit Existing Image</button>
          <button *ngIf="contentType === 'Image' && selectedContent" type="button" (click)="startCropping(selectedContent, 'content')"
                  class="mt-2 px-4 py-1 text-white bg-accent rounded-lg">Edit Image</button>
          <video *ngIf="contentType === 'Video'" [src]="contentPreview" controls class="max-w-full h-auto rounded-lg" style="max-height: 200px;"></video>
        </div>
      </div> -->

      <div class="sm:col-span-2">
              <label for="order" class="mb-2 block text-sm font-medium text-slate-600">Order</label>
              <input id="order" [(ngModel)]="_project.order" name="order" type="number"
                     class="block w-full p-3 text-sm text-slate-700  bg-slate-50 rounded-xl border border-slate-200 focus:ring-brand focus:border-brand transition-all duration-200"
                     placeholder="Enter order" />
            </div>

      
    </div>

    <!-- Image Cropper Modal -->
    <div *ngIf="showCropper" class="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm">
      <div class="w-full max-w-lg rounded-2xl border border-slate-200 bg-white p-6 shadow-xl">
        <h3 class="mb-4 text-lg font-semibold text-slate-900">Edit {{ cropperType === 'thumbnail' ? 'Thumbnail' : 'Content' }} image</h3>
        <image-cropper
          [imageBase64]="imageToCrop"
          [maintainAspectRatio]="true"
          [aspectRatio]="cropperType === 'thumbnail' ? 2 / 1 : 4 / 3"
          format="jpeg"
          (imageCropped)="imageCropped($event)"
          [resizeToWidth]="cropperType === 'thumbnail' ? 800 : 1200"
          [resizeToHeight]="cropperType === 'thumbnail' ? 400 : 900"
        ></image-cropper>
        <div class="mt-4 flex justify-end gap-3">
          <button
            type="button"
            (click)="closeCropper()"
            class="rounded-full border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 transition hover:bg-slate-100 hover:text-slate-900"
          >
            Cancel
          </button>
          <button
            type="button"
            (click)="closeCropper()"
            class="rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white transition hover:bg-brand/90"
          >
            Save
          </button>
        </div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="mt-6 flex justify-end gap-4">
      <a
        [routerLink]="['/dashboard/projects']"
        class="rounded-full border border-slate-200 px-6 py-2 text-sm font-medium text-slate-600 transition hover:bg-slate-100 hover:text-slate-900"
      >
        Cancel
      </a>
      <button
        type="submit"
        class="inline-flex items-center gap-2 rounded-full bg-brand px-6 py-2 text-sm font-semibold text-white transition hover:-translate-y-0.5 hover:bg-brand/90"
      >
        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
        {{ mode === 'create' ? 'Save project' : 'Update project' }}
      </button>
    </div>
  </form>
</div>