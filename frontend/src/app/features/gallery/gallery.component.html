<div class="space-y-6">
  <div class="flex items-center justify-between gap-4">
    <div>
      <h6 class="text-xl font-semibold text-slate-900">Gallery</h6>
      <p class="text-sm text-slate-500">Curate the imagery and video that powers your portfolio.</p>
    </div>
    <button
      type="button"
      class="rounded-full bg-brand px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:-translate-y-0.5 hover:bg-brand/90"
      (click)="toggleCreateModal()"
    >
      Upload media
    </button>
  </div>

  <div class="flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-5 shadow-sm sm:flex-row sm:items-center sm:justify-between">
    <div class="flex items-center gap-3 text-sm text-slate-600">
      <label class="text-sm text-slate-500">Rows per page</label>
      <select
        class="rounded-full border border-slate-300 bg-white px-4 py-2 text-sm text-slate-700 shadow-sm focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/30"
        [ngModel]="pageSize"
        (ngModelChange)="onPageSizeChange($event)"
      >
        <option [ngValue]="5">5</option>
        <option [ngValue]="10">10</option>
        <option [ngValue]="20">20</option>
        <option [ngValue]="50">50</option>
      </select>
    </div>

    <div class="text-sm text-slate-500">
      Showing
      <span class="font-semibold text-slate-900">
        {{ (currentPage - 1) * pageSize + 1 }} – {{ Math.min(currentPage * pageSize, totalItems) }}
      </span>
      of <span class="font-semibold text-slate-900">{{ totalItems }}</span>
    </div>
  </div>

  <div class="overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm">
    <table class="min-w-full table-auto divide-y divide-slate-100 text-left text-sm text-slate-600">
      <thead class="bg-slate-100/80 text-xs font-semibold uppercase tracking-wide text-slate-500">
        <tr>
          <th class="px-6 py-3">Title</th>
          <th class="px-6 py-3">Description</th>
          <th class="px-6 py-3">Type</th>
          <th class="px-6 py-3">Content</th>
          <th class="px-6 py-3">Status</th>
          <th class="px-6 py-3">Order</th>
          <th class="px-6 py-3 text-right">Actions</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-100">
        <tr *ngFor="let item of pagedGallery" class="transition duration-150 hover:bg-slate-50">
          <th scope="row" class="px-6 py-4 font-medium text-slate-900">{{ item.title }}</th>
          <td class="px-6 py-4">{{ item.description || '—' }}</td>
          <td class="px-6 py-4">{{ item.contentType }}</td>
          <td class="px-6 py-4">
            <ng-container *ngIf="item.contentType === 'Image'; else videoContent">
              <img
                class="h-12 w-20 rounded-lg object-cover ring-1 ring-slate-200"
                [src]="baseUrl + '/api/attachment/get/' + item.contentName"
                alt="{{ item.title }} preview"
              />
            </ng-container>
            <ng-template #videoContent>
              <video class="h-12 w-20 rounded-lg ring-1 ring-slate-200" preload="metadata" controls>
                <source [src]="baseUrl + '/api/attachment/get/' + item.contentName" type="video/mp4" />
              </video>
            </ng-template>
          </td>
          <td class="px-6 py-4">
            <span
              *ngIf="item.isActive; else inactiveBadge"
              class="inline-flex items-center gap-1 rounded-full bg-brand/10 px-3 py-1 text-xs font-medium text-brand"
            >
              <i class="fas fa-check-circle"></i>
              Active
            </span>
          </td>
          <td class="px-6 py-4">{{ item.order }}</td>
          <td class="px-6 py-4">
            <div class="flex flex-wrap justify-end gap-2">
              <button
                (click)="openEditModal(item)"
                class="rounded-full border border-brand/20 px-4 py-2 text-sm font-medium text-brand transition hover:bg-brand hover:text-white"
              >
                Edit
              </button>
              <button
                *ngIf="item.isActive"
                (click)="itemActiveInactive(item.id, false)"
                class="rounded-full border border-amber-200 px-4 py-2 text-sm font-medium text-amber-600 transition hover:bg-amber-50"
              >
                Deactivate
              </button>
              <button
                *ngIf="!item.isActive"
                (click)="itemActiveInactive(item.id, true)"
                class="rounded-full border border-brand/20 px-4 py-2 text-sm font-medium text-brand transition hover:bg-brand hover:text-white"
              >
                Activate
              </button>
              <button
                (click)="itemDelete(item.id)"
                class="rounded-full border border-rose-200 px-4 py-2 text-sm font-medium text-rose-600 transition hover:bg-rose-50"
              >
                Delete
              </button>
            </div>
          </td>
        </tr>
        <ng-template #inactiveBadge>
          <span class="inline-flex items-center gap-1 rounded-full bg-rose-50 px-3 py-1 text-xs font-medium text-rose-500">
            <i class="fas fa-times-circle"></i>
            Inactive
          </span>
        </ng-template>
        <tr *ngIf="!totalItems" class="text-center text-sm text-slate-500">
          <td colspan="7" class="px-6 py-8">No media uploaded yet.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="flex flex-col gap-3 text-sm text-slate-500 sm:flex-row sm:items-center sm:justify-between">
    <div>
      Page <span class="font-semibold text-slate-900">{{ currentPage }}</span> of
      <span class="font-semibold text-slate-900">{{ pageCount }}</span>
    </div>
    <div class="inline-flex flex-wrap items-center gap-2">
      <button
        (click)="changePage(-1)"
        [disabled]="currentPage === 1"
        class="rounded-full border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 transition enabled:hover:bg-slate-100 enabled:hover:text-slate-900 disabled:opacity-40"
      >
        Previous
      </button>
      <ng-container *ngFor="let p of pages">
        <button
          (click)="goToPage(p)"
          class="h-9 w-9 rounded-full border px-3 text-sm font-medium transition"
          [ngClass]="
            p === currentPage
              ? 'border-brand bg-brand text-white shadow-sm'
              : 'border-slate-200 text-slate-600 hover:bg-slate-100 hover:text-slate-900'
          "
        >
          {{ p }}
        </button>
      </ng-container>
      <button
        (click)="changePage(1)"
        [disabled]="currentPage === pageCount"
        class="rounded-full border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 transition enabled:hover:bg-slate-100 enabled:hover:text-slate-900 disabled:opacity-40"
      >
        Next
      </button>
    </div>
  </div>

  <div
    *ngIf="showCreateModal"
    class="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 px-4 backdrop-blur-sm"
    (click)="toggleCreateModal()"
  >
    <div
      class="w-full max-w-lg overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl"
      (click)="$event.stopPropagation()"
    >
      <div class="flex items-center justify-between border-b border-slate-200 px-6 py-4">
        <h3 class="text-lg font-semibold text-slate-900">Create gallery item</h3>
        <button
          type="button"
          (click)="toggleCreateModal()"
          class="rounded-full p-2 text-slate-500 transition hover:bg-slate-100 hover:text-slate-900"
          aria-label="Close"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form (ngSubmit)="createData()" class="space-y-5 px-6 py-6">
        <div>
          <label for="title" class="mb-1.5 block text-sm font-medium text-slate-700">Title *</label>
          <input
            type="text"
            id="title"
            [(ngModel)]="newItem.title"
            name="title"
            required
            class="w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm transition focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/30"
          />
        </div>
        <div>
          <label for="description" class="mb-1.5 block text-sm font-medium text-slate-700">Description</label>
          <textarea
            id="description"
            [(ngModel)]="newItem.description"
            name="description"
            rows="3"
            class="w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm transition focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/30"
          ></textarea>
        </div>
        <div>
          <label for="contentType" class="mb-1.5 block text-sm font-medium text-slate-700">Content type *</label>
          <select
            id="contentType"
            [(ngModel)]="newItem.contentType"
            name="contentType"
            required
            class="w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm transition focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/30"
          >
            <option value="">Select type</option>
            <option value="Image">Image</option>
            <option value="Video">Video</option>
          </select>
        </div>
        <div>
          <label for="file" class="mb-1.5 block text-sm font-medium text-slate-700">Content file</label>
          <input
            type="file"
            id="file"
            (change)="onFileChange($event)"
            accept="image/*,video/*"
            class="w-full cursor-pointer rounded-xl border border-dashed border-slate-300 bg-white px-4 py-3 text-sm text-slate-600 file:mr-3 file:cursor-pointer file:rounded-full file:border-0 file:bg-brand/10 file:px-4 file:py-2 file:text-brand hover:border-brand/40"
          />
        </div>
        <div>
          <label for="order" class="mb-1.5 block text-sm font-medium text-slate-700">Order</label>
          <input
            type="number"
            id="order"
            [(ngModel)]="newItem.order"
            name="order"
            min="0"
            class="w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm transition focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/30"
          />
        </div>
        <div class="flex items-center justify-end gap-3">
          <button
            type="button"
            (click)="toggleCreateModal()"
            class="rounded-full border border-slate-200 px-5 py-2.5 text-sm font-medium text-slate-600 transition hover:bg-slate-100 hover:text-slate-900"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="inline-flex items-center gap-2 rounded-full bg-brand px-6 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:-translate-y-0.5 hover:bg-brand/90"
          >
            <i class="fas fa-check"></i>
            Create
          </button>
        </div>
      </form>
    </div>
  </div>

  <div
    *ngIf="showEditModal"
    class="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 px-4 backdrop-blur-sm"
    (click)="toggleEditModal()"
  >
    <div
      class="w-full max-w-lg overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl"
      (click)="$event.stopPropagation()"
    >
      <div class="flex items-center justify-between border-b border-slate-200 px-6 py-4">
        <h3 class="text-lg font-semibold text-slate-900">Edit gallery item</h3>
        <button
          type="button"
          (click)="toggleEditModal()"
          class="rounded-full p-2 text-slate-500 transition hover:bg-slate-100 hover:text-slate-900"
          aria-label="Close"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form (ngSubmit)="editData()" class="space-y-5 px-6 py-6">
        <div>
          <label for="editTitle" class="mb-1.5 block text-sm font-medium text-slate-700">Title *</label>
          <input
            type="text"
            id="editTitle"
            [(ngModel)]="editItem.title"
            name="title"
            required
            class="w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm transition focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/30"
          />
        </div>
        <div>
          <label for="editDescription" class="mb-1.5 block text-sm font-medium text-slate-700">Description</label>
          <textarea
            id="editDescription"
            [(ngModel)]="editItem.description"
            name="description"
            rows="3"
            class="w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm transition focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/30"
          ></textarea>
        </div>
        <div>
          <label for="editContentType" class="mb-1.5 block text-sm font-medium text-slate-700">Content type *</label>
          <select
            id="editContentType"
            [(ngModel)]="editItem.contentType"
            name="contentType"
            required
            class="w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm transition focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/30"
          >
            <option value="">Select type</option>
            <option value="Image">Image</option>
            <option value="Video">Video</option>
          </select>
        </div>
        <div>
          <label for="editFile" class="mb-1.5 block text-sm font-medium text-slate-700">Update content file</label>
          <input
            type="file"
            id="editFile"
            (change)="onEditFileChange($event)"
            accept="image/*,video/*"
            class="w-full cursor-pointer rounded-xl border border-dashed border-slate-300 bg-white px-4 py-3 text-sm text-slate-600 file:mr-3 file:cursor-pointer file:rounded-full file:border-0 file:bg-brand/10 file:px-4 file:py-2 file:text-brand hover:border-brand/40"
          />
        </div>
        <div>
          <label for="editOrder" class="mb-1.5 block text-sm font-medium text-slate-700">Order</label>
          <input
            type="number"
            id="editOrder"
            [(ngModel)]="editItem.order"
            name="order"
            min="0"
            class="w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm transition focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/30"
          />
        </div>
        <div class="flex items-center justify-end gap-3">
          <button
            type="button"
            (click)="toggleEditModal()"
            class="rounded-full border border-slate-200 px-5 py-2.5 text-sm font-medium text-slate-600 transition hover:bg-slate-100 hover:text-slate-900"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="inline-flex items-center gap-2 rounded-full bg-brand px-6 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:-translate-y-0.5 hover:bg-brand/90"
          >
            <i class="fas fa-check"></i>
            Update
          </button>
        </div>
      </form>
    </div>
  </div>
</div>